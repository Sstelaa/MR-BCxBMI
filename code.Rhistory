library(TwoSampleMR)
library(MRInstruments)
library(ieugwasr)
library(devtools)
Sys.setenv(OPENGWAS_JWT = "eyJhbGciOiJSUzI1NiIsImtpZCI6ImFwaS1qd3QiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJhcGkub3Blbmd3YXMuaW8iLCJhdWQiOiJhcGkub3Blbmd3YXMuaW8iLCJzdWIiOiJ2aWxoYXIuc0BnbWFpbC5jb20iLCJpYXQiOjE3MTc0Mjg4MDIsImV4cCI6MTcxODYzODQwMn0.pVFcGa8QLK6u_KVaQpZpgcWnzUel1jGGPaIdQRTYQQQLMFOeCKXoQG6JvmlUQv-dbv336faik2yM2bFqs8sDYn7i_wLmWOmKrePWZmCtfyMlQrSg-lOGhQg60-3XpEyLc2S42_ylqJipKmESSqLFnyExVwjieno1vtKj-NzytgOG2vxMAVJN_8hpMNa6TlySjtnN8sdrHXBat2uO_5AxP_IxG8fkydfEteRQToCnNWM2Or3bapIyZBA9F2o6UDsoKYamqssWy5OQOcbvXD3gq2QGMsUdzfivQYqM90MXTql7da9lEYKPtb2BoLKY7Xnz2o21syvAlRIsG2tcutg8hQ")
exposure_gwas_BC_AA <- subset(gwas_catalog, grepl("AA", Phenotype_info) & Phenotype_simple == "Breast cancer")
View(exposure_gwas_BC_AA)
gwas_catalog
exposure_gwas <- gwas_catalog
View(exposure_gwas)
exposure_gwas_bc_aa <- subset(gwas_catalog, grepl("African", Initial_sample_description) & Phenotype_simple == "Breast cancer")
View(exposure_gwas_bc_aa)
exposure_data <- format_data(exposure_gwas_bc_aa)
exposure_data <- clump_data(exposure_data, clump_r2 = 0.001)
ao <- available_outcomes()
outcome_data <- extract_instruments(outcomes = 'ukb-e-21001_AFR')
View(outcome_data)
outcome_gwas <- subset(ao, grepl("body mass index", trait))
View(outcome_gwas)
View(ao)
outcome_data <- extract_outcome_data(
snps = exposure_data$SNP, outcomes = "ukb-e-23104_AFR"
)
h_data <- harmonise_data(
exposure_dat = exposure_data,
outcome_dat = outcome_data
)
View(h_data)
mr_results <- mr(h_data)
View(mr_results)
mr_method_list()
mr_pleiotropy_test(h_data)
pleiotropy <- mr_pleiotropy_test(h_data)
View(pleiotropy)
heterogeneity <- mr_heterogeneity(h_data, method_list = c("mr_egger_regression", "mr_ivw"))
View(heterogeneity)
scatter_plot <- mr_scatter_plot(mr_results, h_data)
View(scatter_plot)
View(scatter_plot)
scatter_plot
res_single <- mr_singlesnp(h_data)
forrest_plot <- mr_forest_plot(res_single)
forrest_plot
funnel_plot <- mr_funnel_plot(res_single)
funnel_plot
View(mr_results)
View(mr_results)
install.packages("writexl")
library(writexl)
write_xlsx(exposure_data, path = "exposure_data.xlsx")
write_xlsx(outcome_data, path = "outcome_data.xlsx")
write_xlsx(h_data, path = "harmonised_data_for_analyses.xlsx")
write_xlsx(mr_results, path = "mr_results.xlsx")
write_xlsx(heterogeneity, path = "heterogeneity_results.xlsx")
View(pleiotropy)
write_xlsx(pleiotropy, path = "pleiotropy_results.xlsx")
savehistory("~/Desktop/Mendelian Randomisation/BC_BMI/BC+BMI/code.Rhistory")
